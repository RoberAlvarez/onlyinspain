<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Favicon for browser tab and apps -->
<link rel="icon" type="image/png" href="https://flagdownload.com/wp-content/uploads/Flag_of_Spain_Flat_Wavy-2048x1571.png">
<!-- Apple Touch Icon for iOS "Add to Home Screen" -->
<link rel="apple-touch-icon" href="https://flagdownload.com/wp-content/uploads/Flag_of_Spain_Flat_Wavy-2048x1571.png">
<!-- Google "manifest" icon (optional for PWA support) -->
<link rel="manifest" href="/manifest.json">
  <meta property="og:image" content="https://flagdownload.com/wp-content/uploads/Flag_of_Spain_Flat_Wavy-2048x1571.png">
<meta name="theme-color" content="#0d6efd">

    <meta charset="UTF-8">
    <title>Only in Spain</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: #f7fafc;
        }
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(44,62,80,.03);
        }
        .flag {
            font-size: 2rem;
        }
        .main-header {
            font-weight: 800;
            letter-spacing: -1px;
            color: #234567;
        }
        .intro-panel {
            background: linear-gradient(98deg,#f3f6fa 65%, #fff 100%);
            border-radius: 1.3rem;
            border: 1px solid #e7eaf3;
        }
        .action-btn {
            transition: 0.15s;
        }
        .action-btn.active, .action-btn:focus {
            background: #e9f1fd;
            color: #0d6efd;
            border-color: #b6d5fa;
        }
        .story-card {
            border-radius: 1.2rem;
            border: 1px solid #e7eaf3;
            box-shadow: 0 2px 12px 0 rgba(0,0,0,0.04);
            transition: box-shadow 0.15s;
        }
        .story-card:hover {
            box-shadow: 0 4px 20px 0 rgba(13,110,253,.07);
            border-color: #d1e6fd;
        }
        .vote-btn {
            border: none;
            background: #f3f8ff;
            border-radius: 50%;
            padding: 0.35rem 0.8rem;
            font-weight: 700;
            color: #0d6efd;
            transition: 0.1s;
        }
        .vote-btn:hover, .vote-btn:focus {
            background: #d1e6fd;
            color: #093b79;
            transform: translateY(-2px) scale(1.07);
            box-shadow: 0 2px 12px #b6d5fa70;
        }
        .story-title {
            line-height: 1.2;
            font-weight: 700;
            font-size: 1.15rem;
            color: #23344a;
        }
        .story-body {
            color: #3a4556;
            font-size: 1.05rem;
        }
        .story-meta {
            font-size: .96rem;
        }
        @media (max-width: 600px) {
            .container {
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }
            .main-header {
                font-size: 1.4rem;
            }
            .flag {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- Sticky Header -->
    <header class="bg-white sticky-header mb-4">
        <div class="container d-flex justify-content-between align-items-center py-3">
            <div class="d-flex align-items-center gap-2">
            <img src="https://flagdownload.com/wp-content/uploads/Flag_of_Spain_Flat_Wavy-2048x1571.png"
                 alt="ES Flag" class="flag rounded shadow-sm" style="height:2.3rem;width:2.3rem;object-fit:cover;">

                <span class="main-header fs-3">Only in Spain</span>
            </div>
            <nav style="display:none">
                <a href="mailto:youremail@example.com" class="text-primary text-decoration-none fw-semibold">Contact</a>
            </nav>
        </div>
    </header>
    <!-- Main Content -->
    <main class="container" style="max-width: 700px;">
        <!-- Intro Panel -->
<section class="intro-panel p-4 mb-4 shadow-sm">
    <div class="d-flex align-items-center mb-2">
        <img src="https://flagdownload.com/wp-content/uploads/Flag_of_Spain_Flat_Wavy-2048x1571.png"
             alt="Spain Flag" class="flag me-2 rounded shadow-sm" style="height:2.3rem;width:2.3rem;object-fit:cover;">
        <h2 class="mb-0 fs-5 fw-bold">Share your üá™üá∏ Spain story</h2>
    </div>
    <p class="mb-1 fw-semibold">Spain isn‚Äôt always what you see in the tourist ads. Sometimes it‚Äôs effortless. Sometimes it‚Äôs a maze of paperwork, waiting, or the unexpected.</p>
    <p>
        This board is for stories about the things that only happen here‚Äîbureaucracy, housing, healthcare, local customs, or the moments that make you pause and say, ‚Äúonly in Spain.‚Äù
    </p>
    <div class="mb-2 mt-2">
        <span class="badge bg-secondary me-1">Anonymous</span>
        <span class="badge bg-secondary me-1">No account</span>
        <span class="badge bg-secondary">No email</span>
    </div>
    <p class="mb-2">
        Got a story that made you say ‚Äúonly in Spain‚Äù? Share it below.
    </p>
    <div class="fs-3">üèñÔ∏èü•òüìÑüöâ</div>
</section>



        <!-- Action Bar -->
        <div class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-4">
            <div>
                <a href="{% url 'home' %}?sort=new"
                   class="btn btn-outline-primary btn-sm me-1 action-btn {% if sort == 'new' %}active{% endif %}">üìù New</a>
                <a href="{% url 'home' %}?sort=top"
                   class="btn btn-outline-secondary btn-sm me-1 action-btn {% if sort == 'top' %}active{% endif %}">üî• Top</a>
            </div>
            <a href="{% url 'submit' %}" class="btn btn-primary fw-semibold px-4 py-2">+ Post your U.S. story</a>
        </div>
        <!-- Story List -->
        {% for post in posts %}
        <div class="story-card bg-white p-4 mb-4">

            <a href="{% url 'view_post' post.id %}" class="text-decoration-none text-dark">
                <h3 class="story-title mb-2">{{ post.title }}</h3>
                <div class="story-body mb-3">{{ post.content|linebreaks|truncatewords_html:40 }}</div>
            </a>
            <div class="d-flex justify-content-between align-items-center story-meta">
                <span>{{ post.created_at|date:"j M Y" }}</span>
                    <button
                        class="vote-btn"
                        title="Upvote"
                        data-post-id="{{ post.id }}"
                        id="vote-btn-{{ post.id }}"
                    >
                        ‚ñ≤ <span id="vote-count-{{ post.id }}">{{ post.votes }}</span>
                    </button>
            </div>
        </div>
        {% empty %}
        <div class="bg-white p-4 rounded shadow-sm text-center text-secondary">
            <p>No posts yet. Be the first!</p>
        </div>
        {% endfor %}
    </main>
    <!-- Bootstrap JS (optional, for interactive features) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.vote-btn').forEach(function(btn) {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            var postId = this.dataset.postId;
            var btnRef = this;
            // Prevent multiple votes
            if (btnRef.classList.contains('voted')) return;

            fetch('{% url "upvote" 0 %}'.replace('0', postId), {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                    'X-Requested-With': 'XMLHttpRequest'
                },
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'ok') {
                    document.getElementById('vote-count-' + postId).innerText = data.votes;
                    btnRef.classList.add('voted');
                    btnRef.setAttribute('disabled', true);
                }
            });
        });
    });
});
</script>

</body>
</html>
